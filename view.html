<!DOCTYPE html>
<html lang="es" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carpeta Compartida - LinkApp</title>
    
    <link rel="stylesheet" href="estilos.css?v=1.2">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        bg: "#000000", surface: "#18181b", border: "#27272a",
                        blue: "#38BDF8", teal: "#2DD4BF", text: "#E2E8F0"
                    }
                }
            }
        };

        // CONEXIÓN (Usa las mismas llaves que en funcion.html)
        let supabaseClient;
        try {
            const supabaseUrl = 'TU_URL_AQUÍ';
            const supabaseKey = 'TU_KEY_AQUÍ';
            supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);
        } catch (e) { console.error(e); }
    </script>
</head>

<body class="min-h-screen bg-bg text-text relative overflow-x-hidden">
    <div class="bg-mesh"></div>

    <main class="max-w-3xl mx-auto px-6 py-20">
        <div class="text-center mb-12">
            <img src="logo1.png" alt="Logo" class="w-12 h-16 mx-auto mb-6">
            <h1 id="folderTitle" class="text-4xl font-black text-white mb-2">Cargando carpeta...</h1>
            <p id="creatorName" class="text-muted text-sm uppercase tracking-widest font-bold"></p>
        </div>

        <div id="linksContainer" class="grid gap-4">
            </div>

        <div class="mt-16 text-center">
            <a href="index.html" class="text-xs font-black uppercase tracking-[0.3em] text-muted hover:text-blue transition">
                Creado con LinkApp
            </a>
        </div>
    </main>

    <script>
        // Lógica para leer la base de datos
        const params = new URLSearchParams(window.location.search);
        const folderId = params.get('id');

        async function cargarCarpeta() {
            if (!folderId) {
                document.getElementById('folderTitle').textContent = "Enlace no válido";
                return;
            }

            try {
                const { data, error } = await supabaseClient
                    .from('carpetas')
                    .select('*')
                    .eq('id', folderId)
                    .single();

                if (error || !data) throw error;

                // Llenar los datos
                document.getElementById('folderTitle').innerHTML = `Colección: <span class="gradient-text">${data.nombre}</span>`;
                document.getElementById('creatorName').textContent = `Compartido por: ${data.user_nickname}`;

                const container = document.getElementById('linksContainer');
                container.innerHTML = data.links.map(link => `
                    <a href="${link}" target="_blank" 
                       class="folder-card p-6 rounded-2xl border border-border flex justify-between items-center group hover:border-blue transition-all">
                        <span class="text-sm font-medium text-muted group-hover:text-white truncate pr-4">
                            ${link.replace('https://', '').replace('http://', '')}
                        </span>
                        <span class="text-blue opacity-0 group-hover:opacity-100 transition-opacity">↗</span>
                    </a>
                `).join('');

            } catch (err) {
                document.getElementById('folderTitle').textContent = "Carpeta no encontrada";
                console.error(err);
            }
        }

        cargarCarpeta();
    </script>
</body>
</html>